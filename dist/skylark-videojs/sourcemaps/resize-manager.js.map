{"version":3,"sources":["resize-manager.js"],"names":["define","Fn","Events","mergeOptions","Component","ResizeManager","[object Object]","player","options","RESIZE_OBSERVER_AVAILABLE","ResizeObserver","window","super","createEl","reportTouchActivity","this","loadListener_","resizeObserver_","debouncedHandler_","debounce","resizeHandler","observe","el","el_","contentWindow","unloadListener_","off","on","listenToOnce","className","tabIndex","aria-hidden","player_","trigger","cancel","unobserve","disconnect","unlistenTo","call","resizeObserver","dispose","registerComponent"],"mappings":";;;;;;;AAAAA,QACI,aACA,iBACA,wBACA,eACD,SAAWC,EAAIC,EAAQC,EAAcC,GACpC,mBACMC,UAAsBD,EACxBE,YAAYC,EAAQC,GAChB,IAAIC,EAA4BD,EAAQE,gBAAkBC,OAAOD,eAClC,OAA3BF,EAAQE,iBACRD,GAA4B,GAMhCG,MAAML,EAJWJ,GACbU,UAAWJ,EACXK,qBAAqB,GACtBN,IAEHO,KAAKL,eAAiBF,EAAQE,gBAAkBC,OAAOD,eACvDK,KAAKC,cAAgB,KACrBD,KAAKE,gBAAkB,KACvBF,KAAKG,kBAAoBjB,EAAGkB,SAAS,KACjCJ,KAAKK,iBACN,KAAK,EAAOL,MACXN,GACAM,KAAKE,gBAAkB,IAAIF,KAAKL,eAAeK,KAAKG,mBACpDH,KAAKE,gBAAgBI,QAAQd,EAAOe,QAEpCP,KAAKC,cAAgB,MACjB,IAAKD,KAAKQ,MAAQR,KAAKQ,IAAIC,cACvB,OAEJ,MAAMN,EAAoBH,KAAKG,kBAC/B,IAAIO,EAAkBV,KAAKU,gBAAkB,WACzCvB,EAAOwB,IAAIX,KAAM,SAAUG,GAC3BhB,EAAOwB,IAAIX,KAAM,SAAUU,GAC3BA,EAAkB,MAEtBvB,EAAOyB,GAAGZ,KAAKQ,IAAIC,cAAe,SAAUC,GAC5CvB,EAAOyB,GAAGZ,KAAKQ,IAAIC,cAAe,SAAUN,KAEhDH,KAAKa,aAAa,OAAQb,KAAKC,gBAGvCV,WACI,OAAOM,MAAMC,SAAS,UAClBgB,UAAW,qBACXC,UAAW,IACVC,cAAe,SAExBzB,gBACSS,KAAKiB,SAAYjB,KAAKiB,QAAQC,SAGnClB,KAAKiB,QAAQC,QAAQ,gBAEzB3B,UACQS,KAAKG,mBACLH,KAAKG,kBAAkBgB,SAEvBnB,KAAKE,kBACDF,KAAKiB,QAAQV,MACbP,KAAKE,gBAAgBkB,UAAUpB,KAAKiB,QAAQV,MAEhDP,KAAKE,gBAAgBmB,cAErBrB,KAAKC,eACLD,KAAKsB,WAAW,OAAQtB,KAAKC,eAE7BD,KAAKQ,KAAOR,KAAKQ,IAAIC,eAAiBT,KAAKU,iBAC3CV,KAAKU,gBAAgBa,KAAKvB,KAAKQ,IAAIC,eAEvCT,KAAKL,eAAiB,KACtBK,KAAKwB,eAAiB,KACtBxB,KAAKG,kBAAoB,KACzBH,KAAKC,cAAgB,KACrBJ,MAAM4B,WAId,OADApC,EAAUqC,kBAAkB,gBAAiBpC,GACtCA","file":"../resize-manager.js","sourcesContent":["define([\n    './utils/fn',\n    './utils/events',\n    './utils/merge-options',\n    './component'\n], function ( Fn, Events, mergeOptions, Component) {\n    'use strict';\n    class ResizeManager extends Component {\n        constructor(player, options) {\n            let RESIZE_OBSERVER_AVAILABLE = options.ResizeObserver || window.ResizeObserver;\n            if (options.ResizeObserver === null) {\n                RESIZE_OBSERVER_AVAILABLE = false;\n            }\n            const options_ = mergeOptions({\n                createEl: !RESIZE_OBSERVER_AVAILABLE,\n                reportTouchActivity: false\n            }, options);\n            super(player, options_);\n            this.ResizeObserver = options.ResizeObserver || window.ResizeObserver;\n            this.loadListener_ = null;\n            this.resizeObserver_ = null;\n            this.debouncedHandler_ = Fn.debounce(() => {\n                this.resizeHandler();\n            }, 100, false, this);\n            if (RESIZE_OBSERVER_AVAILABLE) {\n                this.resizeObserver_ = new this.ResizeObserver(this.debouncedHandler_);\n                this.resizeObserver_.observe(player.el());\n            } else {\n                this.loadListener_ = () => {\n                    if (!this.el_ || !this.el_.contentWindow) {\n                        return;\n                    }\n                    const debouncedHandler_ = this.debouncedHandler_;\n                    let unloadListener_ = this.unloadListener_ = function () {\n                        Events.off(this, 'resize', debouncedHandler_);\n                        Events.off(this, 'unload', unloadListener_);\n                        unloadListener_ = null;\n                    };\n                    Events.on(this.el_.contentWindow, 'unload', unloadListener_);\n                    Events.on(this.el_.contentWindow, 'resize', debouncedHandler_);\n                };\n                this.listenToOnce('load', this.loadListener_);\n            }\n        }\n        createEl() {\n            return super.createEl('iframe', {\n                className: 'vjs-resize-manager',\n                tabIndex: -1\n            }, { 'aria-hidden': 'true' });\n        }\n        resizeHandler() {\n            if (!this.player_ || !this.player_.trigger) {\n                return;\n            }\n            this.player_.trigger('playerresize');\n        }\n        dispose() {\n            if (this.debouncedHandler_) {\n                this.debouncedHandler_.cancel();\n            }\n            if (this.resizeObserver_) {\n                if (this.player_.el()) {\n                    this.resizeObserver_.unobserve(this.player_.el());\n                }\n                this.resizeObserver_.disconnect();\n            }\n            if (this.loadListener_) {\n                this.unlistenTo('load', this.loadListener_);\n            }\n            if (this.el_ && this.el_.contentWindow && this.unloadListener_) {\n                this.unloadListener_.call(this.el_.contentWindow);\n            }\n            this.ResizeObserver = null;\n            this.resizeObserver = null;\n            this.debouncedHandler_ = null;\n            this.loadListener_ = null;\n            super.dispose();\n        }\n    }\n    Component.registerComponent('ResizeManager', ResizeManager);\n    return ResizeManager;\n});"]}