/**
 * skylark-videojs - A version of video.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-globals/window","skylark-langx-objects","skylark-langx-types","skylark-net-http/Xhr"],function(e,t,n,r){"use strict";var o=function(e){var t={};return e?(e.trim().split("\n").forEach(function(e){var n=e.indexOf(":"),r=e.slice(0,n).trim().toLowerCase(),o=e.slice(n+1).trim();void 0===t[r]?t[r]=o:Array.isArray(t[r])?t[r].push(o):t[r]=[t[r],o]}),t):t};function s(e,r,o){var s=e;return n.isFunction(r)?(o=r,"string"==typeof e&&(s={uri:e})):s=t.mixin({},r,{uri:e}),s.callback=o,s}function a(e,t,n){return u(t=s(e,t,n))}function u(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,r,o){t||(t=!0,e.callback(n,r,o))};function r(e){return clearTimeout(l),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,w)}function s(){if(!i){var t;clearTimeout(l),t=e.useXDR&&void 0===c.status?200:1223===c.status?204:c.status;var r=w,s=null;return 0!==t?(r={body:function(){var e=void 0;if(e=c.response?c.response:c.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(c),y)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:d,headers:{},url:p,rawRequest:c},c.getAllResponseHeaders&&(r.headers=o(c.getAllResponseHeaders()))):s=new Error("Internal XMLHttpRequest Error"),n(s,r,r.body)}}var u,i,c=e.xhr||null;c||(c=e.cors||e.useXDR?new a.XDomainRequest:new a.XMLHttpRequest);var l,p=c.url=e.uri||e.url,d=c.method=e.method||"GET",f=e.body||e.data,h=c.headers=e.headers||{},m=!!e.sync,y=!1,w={body:void 0,headers:{},statusCode:0,method:d,url:p,rawRequest:c};if("json"in e&&!1!==e.json&&(y=!0,h.accept||h.Accept||(h.Accept="application/json"),"GET"!==d&&"HEAD"!==d&&(h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json"),f=JSON.stringify(!0===e.json?f:e.json))),c.onreadystatechange=function(){4===c.readyState&&setTimeout(s,0)},c.onload=s,c.onerror=r,c.onprogress=function(){},c.onabort=function(){i=!0},c.ontimeout=r,c.open(d,p,!m,e.username,e.password),m||(c.withCredentials=!!e.withCredentials),!m&&e.timeout>0&&(l=setTimeout(function(){if(!i){i=!0,c.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",r(e)}},e.timeout)),c.setRequestHeader)for(u in h)h.hasOwnProperty(u)&&c.setRequestHeader(u,h[u]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(c.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(c),c.send(f||null),c}return a.XMLHttpRequest=e.XMLHttpRequest||function(){},a.XDomainRequest="withCredentials"in new a.XMLHttpRequest?a.XMLHttpRequest:e.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){a["delete"===e?"del":e]=function(t,n,r){return(n=s(t,n,r)).method=e.toUpperCase(),u(n)}}),function(e,t,n){t=s(e,t,n);var o=r.request(t.uri,t).then(function(e){t.callback(null,o,e)}).catch(function(e,n){t.callback(e,n)});return o}});
//# sourceMappingURL=../sourcemaps/utils/xhr.js.map
