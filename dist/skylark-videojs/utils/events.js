/**
 * skylark-videojs - A version of video.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-globals/document","./dom-data","./guid","./log"],function(e,t,n,r){"use strict";function o(e,n){if(!t.has(e))return;const r=t.get(e);0===r.handlers[n].length&&(delete r.handlers[n],e.removeEventListener?e.removeEventListener(n,r.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+n,r.dispatcher)),Object.getOwnPropertyNames(r.handlers).length<=0&&(delete r.handlers,delete r.dispatcher,delete r.disabled),0===Object.getOwnPropertyNames(r).length&&t.delete(e)}function a(e,t,n,r){n.forEach(function(n){e(t,n,r)})}function i(t){if(t.fixed_)return t;function n(){return!0}function r(){return!1}if(!t||!t.isPropagationStopped){const o=t||window.event;t={};for(const e in o)"layerX"!==e&&"layerY"!==e&&"keyLocation"!==e&&"webkitMovementX"!==e&&"webkitMovementY"!==e&&("returnValue"===e&&o.preventDefault||(t[e]=o[e]));if(t.target||(t.target=t.srcElement||e),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){o.preventDefault&&o.preventDefault(),t.returnValue=!1,o.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){o.stopPropagation&&o.stopPropagation(),t.cancelBubble=!0,o.cancelBubble=!0,t.isPropagationStopped=n},t.isPropagationStopped=r,t.stopImmediatePropagation=function(){o.stopImmediatePropagation&&o.stopImmediatePropagation(),t.isImmediatePropagationStopped=n,t.stopPropagation()},t.isImmediatePropagationStopped=r,null!==t.clientX&&void 0!==t.clientX){const n=e.documentElement,r=e.body;t.pageX=t.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),t.pageY=t.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)}t.which=t.charCode||t.keyCode,null!==t.button&&void 0!==t.button&&(t.button=1&t.button?0:4&t.button?1:2&t.button?2:0)}return t.fixed_=!0,t}let l;const s=function(){if("boolean"!=typeof l){l=!1;try{const e=Object.defineProperty({},"passive",{get(){l=!0}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}}return l},d=["touchstart","touchmove"];function c(e,o,l){if(Array.isArray(o))return a(c,e,o,l);t.has(e)||t.set(e,{});const u=t.get(e);if(u.handlers||(u.handlers={}),u.handlers[o]||(u.handlers[o]=[]),l.guid||(l.guid=n.newGUID()),u.handlers[o].push(l),u.dispatcher||(u.disabled=!1,u.dispatcher=function(t,n){if(u.disabled)return;t=i(t);const o=u.handlers[t.type];if(o){const a=o.slice(0);for(let o=0,i=a.length;o<i&&!t.isImmediatePropagationStopped();o++)try{a[o].call(e,t,n)}catch(e){r.error(e)}}}),1===u.handlers[o].length)if(e.addEventListener){let t=!1;s()&&d.indexOf(o)>-1&&(t={passive:!0}),e.addEventListener(o,u.dispatcher,t)}else e.attachEvent&&e.attachEvent("on"+o,u.dispatcher)}function u(e,n,r){if(!t.has(e))return;const i=t.get(e);if(!i.handlers)return;if(Array.isArray(n))return a(u,e,n,r);const l=function(e,t){i.handlers[t]=[],o(e,t)};if(void 0===n){for(const t in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},t)&&l(e,t);return}const s=i.handlers[n];if(s)if(r){if(r.guid)for(let e=0;e<s.length;e++)s[e].guid===r.guid&&s.splice(e--,1);o(e,n)}else l(e,n)}return{fixEvent:i,on:c,off:u,trigger:function e(n,r,o){const a=t.has(n)?t.get(n):{},l=n.parentNode||n.ownerDocument;if("string"==typeof r?r={type:r,target:n}:r.target||(r.target=n),r=i(r),a.dispatcher&&a.dispatcher.call(n,r,o),l&&!r.isPropagationStopped()&&!0===r.bubbles)e.call(null,l,r,o);else if(!l&&!r.defaultPrevented&&r.target&&r.target[r.type]){t.has(r.target)||t.set(r.target,{});const e=t.get(r.target);r.target[r.type]&&(e.disabled=!0,"function"==typeof r.target[r.type]&&r.target[r.type](),e.disabled=!1)}return!r.defaultPrevented},one:function e(t,r,o){if(Array.isArray(r))return a(e,t,r,o);const i=function(){u(t,r,i),o.apply(this,arguments)};i.guid=o.guid=o.guid||n.newGUID(),c(t,r,i)},any:function(e,t,r){const o=function(){u(e,t,o),r.apply(this,arguments)};o.guid=r.guid=r.guid||n.newGUID(),c(e,t,o)}}});
//# sourceMappingURL=../sourcemaps/utils/events.js.map
