/**
 * skylark-videojs - A version of video.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./mixins/stateful","./utils/events","./utils/fn","./utils/log","./event-target","./player"],function(t,e,n,i,s,r){"use strict";const o="plugin",a="activePlugins_",u={},l=t=>u.hasOwnProperty(t),p=t=>l(t)?u[t]:void 0,g=(t,e)=>{t[a]=t[a]||{},t[a][e]=!0},c=(t,e,n)=>{const i=(n?"before":"")+"pluginsetup";t.trigger(i,e),t.trigger(i+":"+e.name,e)},h=function(t,e){const n=function(){c(this,{name:t,plugin:e,instance:null},!0);const n=e.apply(this,arguments);return g(this,t),c(this,{name:t,plugin:e,instance:n}),n};return Object.keys(e).forEach(function(t){n[t]=e[t]}),n},f=(t,e)=>(e.prototype.name=t,function(...n){c(this,{name:t,plugin:e,instance:null},!0);const i=new e(...[this,...n]);return this[t]=(()=>i),c(this,i.getEventHash()),i});class y extends s{constructor(e){if(this.constructor===y)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),t(this,this.constructor.defaultState),g(e,this.name),this.dispose=n.bind(this,this.dispose),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}handleStateChanged(t){}dispose(){const{name:t,player:e}=this;this.trigger("dispose"),this.unlistenTo(),e.off("dispose",this.dispose),e[a][t]=!1,this.player=this.state=null,e[t]=f(t,u[t])}static isBasic(t){const e="string"==typeof t?p(t):t;return"function"==typeof e&&!y.prototype.isPrototypeOf(e.prototype)}static registerPlugin(t,e){if("string"!=typeof t)throw new Error(`Illegal plugin name, "${t}", must be a string, was ${typeof t}.`);if(l(t))i.warn(`A plugin named "${t}" already exists. You may want to avoid re-registering plugins!`);else if(r.prototype.hasOwnProperty(t))throw new Error(`Illegal plugin name, "${t}", cannot share a name with an existing player method!`);if("function"!=typeof e)throw new Error(`Illegal plugin for "${t}", must be a function, was ${typeof e}.`);return u[t]=e,t!==o&&(y.isBasic(e)?r.prototype[t]=h(t,e):r.prototype[t]=f(t,e)),e}static deregisterPlugin(t){if(t===o)throw new Error("Cannot de-register base plugin.");l(t)&&(delete u[t],delete r.prototype[t])}static getPlugins(t=Object.keys(u)){let e;return t.forEach(t=>{const n=p(t);n&&((e=e||{})[t]=n)}),e}static getPluginVersion(t){const e=p(t);return e&&e.VERSION||""}}return y.getPlugin=p,y.BASE_PLUGIN_NAME=o,y.registerPlugin(o,y),r.prototype.usingPlugin=function(t){return!!this[a]&&!0===this[a][t]},r.prototype.hasPlugin=function(t){return!!l(t)},y});
//# sourceMappingURL=sourcemaps/plugin.js.map
