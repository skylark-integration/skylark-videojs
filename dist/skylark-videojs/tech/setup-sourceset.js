/**
 * skylark-videojs - A version of video.js that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-globals/document","../utils/merge-options","../utils/url"],function(e,t,r){"use strict";const n=e=>{const t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;const r=e.$$("source"),n=[];let s="";if(!r.length)return!1;for(let e=0;e<r.length;e++){const t=r[e].src;t&&-1===n.indexOf(t)&&n.push(t)}return!!n.length&&(1===n.length&&(s=n[0]),e.triggerSourceset(s),!0)},s=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(t){const r=e.createElement(this.nodeName.toLowerCase());r.innerHTML=t;const n=e.createDocumentFragment();for(;r.childNodes.length;)n.appendChild(r.childNodes[0]);return this.innerText="",window.Element.prototype.appendChild.call(this,n),this.innerHTML}}),c=(e,t)=>{let r={};for(let n=0;n<e.length&&!((r=Object.getOwnPropertyDescriptor(e[n],t))&&r.set&&r.get);n++);return r.enumerable=!0,r.configurable=!0,r},o=function(e){const r=e.el();if(r.resetSourceWatch_)return;const o={},i=(e=>c([e.el(),window.HTMLMediaElement.prototype,window.Element.prototype,s],"innerHTML"))(e),u=t=>(...s)=>{const c=t.apply(r,s);return n(e),c};["append","appendChild","insertAdjacentHTML"].forEach(e=>{r[e]&&(o[e]=r[e],r[e]=u(o[e]))}),Object.defineProperty(r,"innerHTML",t(i,{set:u(i.set)})),r.resetSourceWatch_=(()=>{r.resetSourceWatch_=null,Object.keys(o).forEach(e=>{r[e]=o[e]}),Object.defineProperty(r,"innerHTML",i)}),e.one("sourceset",r.resetSourceWatch_)},i=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?r.getAbsoluteURL(window.Element.prototype.getAttribute.call(this,"src")):""},set(e){return window.Element.prototype.setAttribute.call(this,"src",e),e}});return function(e){if(!e.featuresSourceset)return;const r=e.el();if(r.resetSourceset_)return;const s=(e=>c([e.el(),window.HTMLMediaElement.prototype,i],"src"))(e),u=r.setAttribute,l=r.load;Object.defineProperty(r,"src",t(s,{set:t=>{const n=s.set.call(r,t);return e.triggerSourceset(r.src),n}})),r.setAttribute=((t,n)=>{const s=u.call(r,t,n);return/src/i.test(t)&&e.triggerSourceset(r.src),s}),r.load=(()=>{const t=l.call(r);return n(e)||(e.triggerSourceset(""),o(e)),t}),r.currentSrc?e.triggerSourceset(r.currentSrc):n(e)||o(e),r.resetSourceset_=(()=>{r.resetSourceset_=null,r.load=l,r.setAttribute=u,Object.defineProperty(r,"src",s),r.resetSourceWatch_&&r.resetSourceWatch_()})}});
//# sourceMappingURL=../sourcemaps/tech/setup-sourceset.js.map
